#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <stdbool.h>

// int
// longest_valid_parentheses (char *s)
// {
//   int size = (int) strlen(s);
//   if (size <= 1) {
//     return 0;
//   }
//   int longest = 0;
//   int **table = malloc(size * sizeof(int *));
//   for (int i = 0; i < size; i++) {
//     table[i] = malloc(size * sizeof(int));
//   }
//   for (int i = 1; i < size; i++) {
//     for (int j = 0; j < size; j++) {
//       int l = j, r = j + i;
//       if (r >= size) {
//         break;
//       }
//       if ((r - l & 1) && s[l] == '(' && s[r] == ')') {
//         if (r - l == 1) {
//           table[l][r] = 2;
//         }
//         else if (table[l+1][r-1]) {
//           table[l][r] = table[l+1][r-1] + 2;
//         }
//         else {
//           int k = l + 1;
//           while (k < r - 1) {
//             if (table[l][k] && table[k+1][r]) {
//               table[l][r] = table[l][k] + table[k+1][r];
//               break;
//             }
//             k++;
//           }
//           if (k == r - 1) {
//             table[l][r] = 0;
//           }
//         }
//         longest = longest > table[l][r] ? longest : table[l][r];
//       }
//       else {
//         table[l][r] = 0;
//       }
//     }
//   }
//   for (int i = 0; i < size; i++) {
//     free(table[i]);
//   }
//   free(table);
//   return longest;
// }

int
longest_valid_parentheses (char *s)
{
  int size = (int) strlen(s);
  if (size <= 1) {
    return 0;
  }
  int *table = malloc((size + 1) * sizeof(int));
  int longest = 0, j = 0;
  table[0] = 0;
  for (int i = 1; i <= size; i++) {
    j = i - 2 - table[i-1];
    if (s[i-1] == '(' || j < 0 || s[j] == ')') {
      table[i] = 0;
    }
    else {
      table[i] = 2 + table[i-1] + table[j];
      longest = longest > table[i] ? longest : table[i];
    }
  }
  return longest;
}

int
main (int argc, char **argv)
{
  char *s = "(()(()()()(()())()(()()))()()())()(((()())((())(()()((()((((())(())()()(())()(()(()(())))))))(()()()))()()))))))(()())))((())())))()(((()(()))())((())))(())(((()()))))())))((()((()()(()))())(()))(())((())()(((()(((()))))()))()()())()()()(()(()(()()()(()(())(())))())()))())(())((())(()((((())((())((())(()()(((()))(()(((())())()(())))(()))))))(()(()(()))())(()()(()(((()()))()(())))(()()(())))))(()(()()())))()()())))))((())(()()(((()(()()))(())))(((()))())())())(((()((()((()())((()))(()()((()(())())(()))()())())))))()(()())))()()))(((()(()))((()((((())((())))((())()()))())()(((()()(((()))))))(((()))()(()(((())(())()()()))))()))()))))()(()))()()()))))()(()))()()(()())))(()))()())(())()())(())()()))(()())))((()())))())))))((()))())()()))))()))(((())(())()))()()((()))(((()))))((()((()))(())(((()))()()()())())())))(()(((())()())(())(((()()((())()))(()()(((())))((()(((()))(((((()(((())())))(())(()()((()(()(())())(((((())((()()))())(()())))()()()(()(((((((())))(()()()()((()(((())())())())))())())())))()((((())(((()()()())()))()()(()(()()))()))(())(()())))))()())()())))()()(())))))))((())()()(((()))()))())))))((()())((()())(((())()())()))(()(()()(((()(())()))()())()()(())()(()))))()))()()))))(())(()()(())((()))(()))((())))))(())))()))(()()(())))())()((())()))((()()(()())()()(()))())(((())()(((()((())()(()()()((()(()())(()())())((((())))())())))(()))(((())((()))))((()()(((())((())()()()))((()())()()())())))))((((()((()())))(())(())()()()(((((())())()()()(())())()((()(()())(((())((((()((()(((()))(()()))())()()(()(()(())))()))())))(()()(()))))))(()()())()()))()(())()(";
  int longest = longest_valid_parentheses(s);
  printf("%d\n", longest);
}
